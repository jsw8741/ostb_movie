<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout1}">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />
</head>
<th:block layout:fragment="css">
</th:block>

<div layout:fragment="content">
	<div class="bg-light py-3">
		<div class="container">
			<div class="row">
				<div class="col-md-12 mb-0 header_margin">
					<a href="/">Home</a> <span class="mx-2 mb-0">/</span> <strong
						class="text-black">스토어</strong>
				</div>
			</div>
		</div>
	</div>
	<div class="site-section">
		<div class="container">
			<h2 th:text="${item.itemNm}"></h2>
			<div class="row">
				<input type="hidden" id="itemId" th:value="${item.id}">
				<div class="asd">
					<img th:src="${item.getItemImgDto().imgUrl}">
				</div>
			</div>
		</div>
	</div>
	<div>
		<form role="form" action="/order" method="post"
			th:object="${OrderDto}">
			<input type="hidden" th:value="${item.id}" name="itemId">
			<div class="col-md-6">
				<span th:text="${item.categori}" class="badge badge-primary mgb-15"></span>
				<h2 class="text-black" th:text="${item.itemNm}"></h2>
				<p>
					<input type="hidden" id="price" name="price"
						th:value="${item.price}"> <strong class="text-primary h4"
						th:text="|${#numbers.formatInteger(item.price, 0, 'COMMA')}원|"></strong>
				</p>
				<div class="mb-5">
					<div class="form-group row">
						<div class="col-md-12">
							<h4 style="padding-top: 50px;">수량</h4>
							<select id="count" onchange="calculateTotalPrice()"
								th:field="*{count}" onclick="calculateTotalPrice()">
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
							</select>
						</div>
					</div>
				</div>
				<div>
					<h5
						style="display: inline-block; margin-right: 15px; color: black; font-weight: bold; width: 110%;">총
						상품 금액</h5>
					<input type="hidden" id="Tprice" th:field="*{totalprice}">
					<h2 id="totalPrices" class="text-primary h4" th:text="|${#numbers.formatInteger(item.price, 0, 'COMMA')}원|"></h2>
				</div>
			</div>
			<div class="form-group">
				<div class="col-md-12">
					<button type="submit">구매하기</button>
					<input type="hidden" th:name="${_csrf.parameterName}"
						th:value="${_csrf.token}">
				</div>
			</div>
		</form>
	</div>
</div>
<th:block layout:fragment="script">
	<script th:inline="javascript">
		function calculateTotalPrice() {
			var count = parseInt($("#count").val());
			var price = parseInt($("#price").val());
			var totalPrice = (price * count).toLocaleString('ko-KR') + '원';
			$("#Tprice").val(totalPrice);
			$("#totalPrices").html(totalPrice);
		}
	</script>
</th:block>
</html>